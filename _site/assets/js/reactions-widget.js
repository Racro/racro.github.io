!function(){"use strict";function t(){const t=localStorage.getItem("reaction_fingerprint");if(t)return t;const e=Date.now().toString(36)+Math.random().toString(36).substr(2,9);return localStorage.setItem("reaction_fingerprint",e),e}async function e(){try{const t=await fetch(`${a}?page=${encodeURIComponent(c)}&type=reactions`);if(!t.ok)throw new Error("Failed to load reactions");n(await t.json())}catch(t){}}function n(t){document.getElementById("reaction-like"),document.getElementById("reaction-loved");const e=document.getElementById("reaction-like-count"),n=document.getElementById("reaction-loved-count");e&&(e.textContent=t.likes||0),n&&(n.textContent=t.loved||0)}async function o(o){const i=document.getElementById("reaction-like"),r=document.getElementById("reaction-loved");i&&(i.disabled=!0),r&&(r.disabled=!0);try{const d=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"reaction",page:c,reaction:o,fingerprint:t()})});if(d.ok){n((await d.json()).reactions);const t="like"===o?i:r;t&&(t.classList.add("reaction-active"),setTimeout((()=>{t.classList.remove("reaction-active")}),300))}else{const t=await d.json();if(!t.alreadyReacted)throw new Error(t.error||"Failed to submit reaction");await e()}}catch(t){}finally{i&&(i.disabled=!1),r&&(r.disabled=!1)}}function i(){e();const t=document.getElementById("reaction-like"),n=document.getElementById("reaction-loved");t&&t.addEventListener("click",(()=>o("like"))),n&&n.addEventListener("click",(()=>o("loved")))}const a=window.COMMENTS_CONFIG?.workerUrl||"";if(!a)return;const c=window.location.pathname;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i()}();